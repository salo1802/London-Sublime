{"mappings":"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","sources":["src/scripts/products.js","src/functions/products.js","src/functions/getUser.js","src/functions/navigation.js"],"sourcesContent":["import { db, auth } from \"./app\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getProducts } from \"../functions/products\";\r\nimport { createFirebaseCart, getFirebaseCart  } from \"../functions/cart\";\r\nimport { addProductToCart, getMyLocalCart, currencyFormat } from \"../utils\";\r\n\r\n\r\nimport {nav} from \"../functions/navigation\"\r\nimport { getUser } from \"../functions/getUser\";\r\n\r\n//nav\r\n\r\n   nav(document);\r\n\r\nconst productSection = document.getElementById(\"products\");\r\nconst categoryFilter = document.getElementById(\"category\");\r\nconst orderFilter = document.getElementById(\"order\");\r\nconst addButton = document.getElementById(\"addProduct\")\r\n\r\nlet userLogged = undefined;\r\nlet products = [];\r\nlet cart = [];\r\n\r\n\r\nasync function loadProducts() {\r\n    const firebaseProducts = await getProducts(db);\r\n    productSection.innerHTML = \"\";\r\n    firebaseProducts.forEach(product => {\r\n        renderProduct(product);\r\n    });\r\n\r\n    products = firebaseProducts;\r\n}\r\n\r\nfunction renderProduct(item) {\r\n    const product = document.createElement(\"a\");\r\n    product.className = \"product\";\r\n\r\n    product.setAttribute(\"href\", `./product.html?id=${item.id}`);\r\n\r\n    const coverImage = item.images ? item.images[0] : \"https://cdn1.iconfinder.com/data/icons/business-company-1/500/image-512.png\";\r\n\r\n    const isProductAddedToCart = cart.some((productCart) => productCart.id === item.id);\r\n\r\n    const productButtonCart = isProductAddedToCart ?\r\n    '<button class=\"product__cart\" disabled>Added to cart</button>' :\r\n    '<button class=\"product__cart\">Add to cart</button>';\r\n\r\n    product.innerHTML = `\r\n    <img src=\"${coverImage}\" alt=\"\" class=\"product__image\">\r\n    <div class=\"product__bot\">\r\n    <div class=\"product__info\">\r\n        <h2 class=\"product__name\">${item.name}</h2>\r\n        <p class=\"product__category\">${item.category}</p> \r\n        <h3 class=\"product__price\">${currencyFormat(item.price)}</h3>\r\n        </div>\r\n        ${productButtonCart}\r\n        </div>\r\n    `;\r\n\r\n    productSection.appendChild(product);\r\n\r\n    const productCartButton = product.querySelector(\".product__cart\");\r\n\r\n    productCartButton.addEventListener(\"click\", async (e) => {\r\n        e.preventDefault(); // evitar que al dar click en el boton, funcione el enlace del padre.\r\n\r\n        cart.push(item);\r\n        addProductToCart(cart);\r\n\r\n        if (userLogged) {\r\n            await createFirebaseCart(db, userLogged.uid, cart);\r\n        }\r\n\r\n        productCartButton.setAttribute(\"disabled\", true);\r\n        productCartButton.innerText = \"Added to cart\";\r\n\r\n    });\r\n}\r\n\r\nfunction filterBy(){\r\n    const newCategory = categoryFilter.value;\r\n    const newOrder = orderFilter.value;\r\n\r\n    let filteredProducts = [];\r\n\r\n    if (newCategory !== \"\") {\r\n        filteredProducts = products.filter((product) => product.category === newCategory);\r\n    } else {\r\n        filteredProducts = products;\r\n    }\r\n\r\n    if (newOrder === \"asc\") {\r\n        filteredProducts = filteredProducts.sort((a, b) => b.price - a.price);\r\n    }\r\n\r\n    if (newOrder === \"desc\") {\r\n        filteredProducts = filteredProducts.sort((a, b) => a.price - b.price);\r\n    }\r\n\r\n    if (newOrder === \"color\") {\r\n        filteredProducts = filteredProducts.sort((a, b) => b.colors.length - a.colors.length );\r\n    }\r\n    \r\n    productSection.innerHTML = \"\";\r\n    filteredProducts.forEach(product => {\r\n        renderProduct(product);\r\n    });\r\n\r\n}\r\n\r\ncategoryFilter.addEventListener(\"change\", e => {\r\n    filterBy();\r\n});\r\n\r\norderFilter.addEventListener(\"change\", e => {\r\n    filterBy();\r\n});\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n      \r\n      userLogged = user;\r\n      \r\n      cart = await getFirebaseCart(db, userLogged.uid);\r\n\r\n      userObject = await getUser(userLogged.uid);\r\n        if(userObject.isAdmin==true){\r\n            addButton.innerHTML = `<a  href=\"./newproduct.html\">+</a>`\r\n        }else{\r\n            addButton.innerHTML = ``;\r\n        }\r\n      // ...\r\n    } else {\r\n        cart = getMyLocalCart();\r\n        addButton.innerHTML = ``;\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadProducts();\r\n\r\n  });","import { collection, getDocs } from \"firebase/firestore\";\r\n\r\nasync function getProducts(db) {\r\n    const collectionRef = collection(db, \"products\");\r\n    try {\r\n        const { docs } =  await getDocs(collectionRef);\r\n        const products = docs.map((doc) => {\r\n            return {\r\n                ...doc.data(),\r\n                id: doc.id,\r\n            };\r\n        });\r\n        return products;\r\n    } catch(e) {\r\n        console.log(e);\r\n    }\r\n}\r\n\r\nexport {\r\n    getProducts,\r\n}","import { db } from \"../scripts/app\";\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\n\r\nasync function getUser(id) {\r\n    const docRef = doc(db, \"users\", id);\r\n    try {\r\n        const docSnap = await getDoc(docRef);\r\n        const data = docSnap.data();\r\n    \r\n        return data; \r\n    } catch(e) {\r\n        console.log(e);\r\n    }\r\n}\r\n\r\nexport {\r\n    getUser\r\n}","\r\nfunction nav(document){\r\n\r\n    const profile = document.getElementsByClassName(\"header__profile\");\r\n    const products = document.getElementsByClassName(\"header__logo\");\r\n    const car = document.getElementsByClassName(\"header__car\");\r\n    console.log(profile)\r\n    if(profile){\r\n        profile[0].addEventListener(\"click\",(e)=>{\r\n            window.location.href = \"./login.html\"\r\n        });\r\n    }\r\n    if(products){\r\n        products[0].addEventListener(\"click\",(e)=>{\r\n            window.location.href = \"./LS products.html\"\r\n        });\r\n    }\r\n    \r\n    if(car){\r\n        car[0].addEventListener(\"click\",(e)=>{\r\n            window.location.href = \"./car.html\"\r\n        });\r\n    }\r\n}\r\n\r\nexport {nav}\r\n\r\n"],"names":["$li1Mx","parcelRequire","$etBjH","document","profile","getElementsByClassName","products","car","console","log","addEventListener","e","window","location","href","$76457545ffdb9fb8$export$80e4b313e5e6b30d","$c066e24865a6ceda$var$productSection","getElementById","$c066e24865a6ceda$var$categoryFilter","$c066e24865a6ceda$var$orderFilter","$c066e24865a6ceda$var$addButton","$c066e24865a6ceda$var$userLogged","$c066e24865a6ceda$var$products","$c066e24865a6ceda$var$cart","async","$c066e24865a6ceda$var$loadProducts","firebaseProducts","db","collectionRef","collection","docs","getDocs","map","doc","data","id","$0218f50cb6a65388$export$68a801b7b3c0bfaa","innerHTML","forEach","product","$c066e24865a6ceda$var$renderProduct","item","createElement","className","setAttribute","coverImage","images","productButtonCart","some","productCart","name","category","$2EF88","currencyFormat","price","appendChild","productCartButton","querySelector","preventDefault","push","addProductToCart","$6naOk","createFirebaseCart","uid","innerText","$c066e24865a6ceda$var$filterBy","newCategory","value","newOrder","filteredProducts","filter","sort","a","b","colors","length","onAuthStateChanged","auth","user","getFirebaseCart","userObject","docRef","getDoc","$f8a12cf1daf47420$export$7cbf767827cd68ba","isAdmin"],"version":3,"file":"LS products.5e18ac8d.js.map"}