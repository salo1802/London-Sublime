{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,yFCCA,SAAaC,GAET,MAAMC,EAAUD,EAASE,uBAAuB,mBAC1CC,EAAWH,EAASE,uBAAuB,gBAC3CE,EAAMJ,EAASE,uBAAuB,eAC5CG,QAAQC,IAAIL,GACTA,GACCA,EAAQ,GAAGM,iBAAiB,SAASC,IACjCC,OAAOC,SAASC,KAAO,kBAG5BR,GACCA,EAAS,GAAGI,iBAAiB,SAASC,IAClCC,OAAOC,SAASC,KAAO,wBAI5BP,GACCA,EAAI,GAAGG,iBAAiB,SAASC,IAC7BC,OAAOC,SAASC,KAAO,gBDVhCC,CAAIZ,UAEP,MAAMa,EAAcb,SAASc,eAAe,QACtCC,EAAef,SAASc,eAAe,SACvCE,EAAShB,SAASc,eAAe,OACjCG,EAAWjB,SAASc,eAAe,YACnCI,EAAYlB,SAASc,eAAe,UAC1C,IAAIK,EAAO,GAEXF,EAASG,QAAS,EAElB,IAAIC,EAAa,EACjB,SAASC,EAASC,GACd,IAAIC,EAAQ,EACZD,EAAKE,SAAQC,KA2BjB,SAAuBA,GACnB,MAAMC,EAAc3B,SAAS4B,cAAc,MAC3CD,EAAYE,UAAY,eACxBF,EAAYG,UAAY,mBAUxBJ,EAAAK,OAAA,sFAGyBL,EAAKM,6CACTC,EAAcC,eAAAR,EAAAS,sEACJT,EAAIU,OAAA,6EAKvCvB,EAAAwB,YAAAV,GACIA,EAAUpB,iBAAA,SAAAC,IAEU,WAAlBA,EAAA8B,OAAaC,UACblC,QAAAC,IAAA,cA7CNkC,eAA6BC,GACzB,MAAMC,EAAUvB,EAAKwB,QAAOjB,GAAWA,EAAQkB,KAAOH,IAEtDtB,EAAOuB,EAEHG,kBACMC,EAAAC,mBAAmBjD,EAAAkD,GAAIH,WAAWI,IAAKP,GAGjDT,EAAAiB,iBAAiBR,GAEjB7B,EAAYiB,UAAY,GAExBR,EAASoB,GAkCLS,CAAOzB,EAAAkB,QAvDPQ,CAAc1B,GACdF,GAAS6B,SAAS3B,EAAQS,OAC1Bd,GAAcgC,SAAS3B,EAAQS,UAGnCpB,EAAauC,UAAY,UAAUrB,EAAAC,eAAeV,KA4DlD+B,mBAAAzD,EAAA0D,MAAAhB,MAAAiB,IACFA,GAEFZ,WAAAY,EACItC,QAAe2B,EAAQY,gBAAA5D,EAAAkD,GAAAH,WAAAI,MACzB9B,EAAAc,EAAA0B,iBACArC,EAAmBH,MAEpBH,EAAAT,iBAAS,SAAiB,KACvBU,EAAmBG,QAAA,OAEQb,iBAAI,SAAA,OACvBa,QAAA,iBAIE,IAACwC,OAESrD,iBAAA,UAAAC,qCAER,SACAF,IAAAuC,WAASI,WAEExB,SAAAC,IACXF,OAAO6B,SAAA3B,EAAAS,MAAA0B,cAEPC,EAAM,CACNL,KAAKZ,WAAOI,IACfa,MAAA3C,EACD4C,QAAY9C,EAAc8C,QAAAF,MAE5BG,SAAA/C,EAAAe,KAAA6B,MAGEI,UAAAhD,EAAuBiD,MAAAL,MAKzBM,MAASlD,EAAAkD,MAAAN,MACPO,IAAQnD,EAAOmD,IAAAP,MAClBQ,KAAAC,YACJ9C,MAAAA","sources":["src/scripts/cart.js","src/functions/navigation.js"],"sourcesContent":["import { auth, db } from \"./app\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getFirebaseCart, createFirebaseCart } from \"../functions/cart\";\r\nimport { addProductToCart } from \"../utils\";\r\nimport { getMyLocalCart, currencyFormat } from \"../utils/index\";\r\nimport {nav} from \"../functions/navigation\"\r\nimport{addDoc, collection} from \"firebase/firestore\"\r\nimport { async } from \"@firebase/util\";\r\n//nav\r\n\r\n   nav(document);\r\n\r\nconst cartSection = document.getElementById(\"cart\");\r\nconst totalSection = document.getElementById(\"total\");\r\nconst buyBtn = document.getElementById(\"buy\");\r\nconst cartForm = document.getElementById(\"cartform\");\r\nconst cancelBtn = document.getElementById(\"cancel\");\r\nlet cart = [];\r\n\r\ncartForm.hidden = true;\r\n\r\nlet totalGobal = 0;\r\nfunction loadCart(cart) {\r\n    let total = 0;\r\n    cart.forEach(product => {\r\n        renderProduct(product);\r\n        total += parseInt(product.price);\r\n        totalGobal += parseInt(product.price);\r\n    });\r\n\r\n    totalSection.innerText = \"Total: \"+currencyFormat(total);\r\n};\r\n\r\nasync function removeProduct(productId) {\r\n    const newCart = cart.filter(product => product.id !== productId);\r\n    \r\n    cart = newCart;\r\n\r\n    if (userLogged) {\r\n        await createFirebaseCart(db, userLogged.uid, newCart);\r\n    }\r\n\r\n    addProductToCart(newCart);\r\n\r\n    cartSection.innerHTML = \"\";\r\n\r\n    loadCart(newCart);\r\n\r\n}\r\n\r\n\r\nfunction renderProduct(product) {\r\n    const productCart = document.createElement(\"li\");\r\n    productCart.className = \"product flex\";\r\n    productCart.innerHTML = `\r\n    <img src=\"${product.images[0]}\" class=\"product__image\">\r\n    <div class=\"info\">\r\n    <h2 class=\"product__name\">${product.name}</h2>\r\n    <h3 class=\"product__price\">${currencyFormat(product.price)}</h3>\r\n    <input class=\"product__color\" type=\"color\" value=\"${product.colors[0]}\"\r\n    </div>\r\n    <button class=\"product__delete\">Delete</button>\r\n    `;\r\n\r\n    cartSection.appendChild(productCart);\r\n\r\n    productCart.addEventListener(\"click\", e => {\r\n         if (e.target.tagName === \"BUTTON\") {\r\n             console.log(\"remove it!\");\r\n             removeProduct(product.id);\r\n         }\r\n    })\r\n};\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n     \r\n      userLogged = user;\r\n      cart = await getFirebaseCart(db, userLogged.uid);\r\n    } else {\r\n        cart = getMyLocalCart();\r\n     \r\n    }\r\n\r\n    loadCart(cart);\r\n\r\n  });\r\n\r\n\r\nbuyBtn.addEventListener(\"click\",()=>{\r\n    cartForm.hidden = false;\r\n})\r\n\r\ncancelBtn.addEventListener(\"click\",()=>{\r\n    cartForm.hidden = true;\r\n})\r\n  //make the purchase\r\n  currentTime = new Date();\r\n cartForm.addEventListener(\"submit\",  (e) => {\r\n    e.preventDefault();\r\n    if(userLogged){\r\n        console.log(userLogged.uid)\r\n        try {\r\n\r\n            cart.forEach(product => {\r\n                total += parseInt(product.price.value);\r\n            });\r\n\r\n            let order = {\r\n                user: userLogged.uid,\r\n                order: cart,\r\n                address: cartForm.address.value,\r\n                username: cartForm.name.value,\r\n                useremail: cartForm.email.value,\r\n                phone: cartForm.phone.value,\r\n                zip: cartForm.zip.value,\r\n                date: currentTime,\r\n                total: total\r\n            }\r\n            console.log(\"Order made\");\r\n           \r\n          addDoc(collection(db,\"users/\"+userLogged.uid+ \"/orders\" ), order).then(\r\n            alert(\"Your order has been made! \"));\r\n           \r\n            cartForm.hidden = true;\r\n           \r\n            \r\n            \r\n            \r\n        } catch(e) {\r\n            console.log(e);\r\n        }\r\n    }\r\n});\r\n\r\n\r\n  ","\r\nfunction nav(document){\r\n\r\n    const profile = document.getElementsByClassName(\"header__profile\");\r\n    const products = document.getElementsByClassName(\"header__logo\");\r\n    const car = document.getElementsByClassName(\"header__car\");\r\n    console.log(profile)\r\n    if(profile){\r\n        profile[0].addEventListener(\"click\",(e)=>{\r\n            window.location.href = \"./login.html\"\r\n        });\r\n    }\r\n    if(products){\r\n        products[0].addEventListener(\"click\",(e)=>{\r\n            window.location.href = \"./LS products.html\"\r\n        });\r\n    }\r\n    \r\n    if(car){\r\n        car[0].addEventListener(\"click\",(e)=>{\r\n            window.location.href = \"./car.html\"\r\n        });\r\n    }\r\n}\r\n\r\nexport {nav}\r\n\r\n"],"names":["$li1Mx","parcelRequire","document","profile","getElementsByClassName","products","car","console","log","addEventListener","e","window","location","href","$76457545ffdb9fb8$export$80e4b313e5e6b30d","$ff14a25859eedfe9$var$cartSection","getElementById","$ff14a25859eedfe9$var$totalSection","$ff14a25859eedfe9$var$buyBtn","$ff14a25859eedfe9$var$cartForm","$ff14a25859eedfe9$var$cancelBtn","$ff14a25859eedfe9$var$cart","hidden","$ff14a25859eedfe9$var$totalGobal","$ff14a25859eedfe9$var$loadCart","cart","total","forEach","product","productCart","createElement","className","innerHTML","images","name","$2EF88","currencyFormat","price","colors","appendChild","target","tagName","async","productId","newCart","filter","id","userLogged","$6naOk","createFirebaseCart","db","uid","addProductToCart","$ff14a25859eedfe9$var$removeProduct","$ff14a25859eedfe9$var$renderProduct","parseInt","innerText","onAuthStateChanged","auth","user","getFirebaseCart","getMyLocalCart","Date","value","order","address","username","useremail","email","phone","zip","date","currentTime"],"version":3,"file":"car.144d8306.js.map"}